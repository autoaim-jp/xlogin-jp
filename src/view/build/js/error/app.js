(()=>{var __defProp=Object.defineProperty,__export=(target,all)=>{for(var name in(target=>__defProp(target,"__esModule",{value:!0}))(target),all)__defProp(target,name,{get:all[name],enumerable:!0})},setting_exports={},browserServerSetting_exports=(__export(setting_exports,{bsc:()=>bsc,get:()=>get2,getBrowserServerSetting:()=>getBrowserServerSetting,scopeExtraConfigList:()=>scopeExtraConfigList,userHmacSecret:()=>userHmacSecret}),{}),apiEndpoint=(__export(browserServerSetting_exports,{apiEndpoint:()=>apiEndpoint,default:()=>browserServerSetting_default,get:()=>get,labelList:()=>labelList,statusList:()=>statusList,userReadableDateFormat:()=>userReadableDateFormat}),"/f"),labelList={scopeBody:{global:{notification:{label:"すべての通知",summary:"すべてのサービスの通知に関する権限です。ログイン時刻などを含みます。"}},auth:{emailAddress:{label:"メールアドレス",summary:"ログインに使用するメールアドレスに関する権限です。バックアップメールアドレスは含みません。"},backupEmailAddress:{label:"バックアップメールアドレス",summary:"バックアップメールアドレスに関する権限です。ログインに使用するメールアドレスは含みません。"},userName:{label:"ユーザー名",summary:"一般公開されているユーザーの名前です。"}},service:{serviceUserId:{label:"ユーザーID",summary:"連携するサービスに提供する、あなたのアカウントのIDです。サービス毎に異なります。"},notification:{label:"サービス内通知",summary:"連携するサービス内で、通知機能を利用するための権限です。"},file:{label:"ファイル",summary:"連携するサービスで、あなたがデータを保存できます。"}}},scopeOperation:{operation:{read:"取得",write:"保存",append:"追記"},prefix:{isRequired:"必須"}},error:{undefined:"error",handle_credential_credential:"メールアドレスまたはパスワードが違います。",handle_user_add_register:"メールアドレスは既に登録されています。",handle_xlogin_code_session:"セッションが不正です。"}},statusList={OK:1,SUCCESS:100,LOGIN_SUCCESS:101,INVALID:1e3,NOT_ENOUGH_PARAM:1001,INVALID_SESSION:1002,API_ERROR:1100,INVALID_OIDC_ISSUER:1101,NOT_FOUND:1200},userReadableDateFormat={full:"YYYY/MM/DD hh:mm:ss",day:"YYYY/MM/DD",hourMinute:"hh:mm",time:"hh:mm:ss"},settingList={apiEndpoint:apiEndpoint,labelList:labelList,statusList:statusList,userReadableDateFormat:userReadableDateFormat},get=(...keyList)=>{var constantList=keyList.reduce((prev,curr)=>(prev[curr]=settingList[curr],prev),{});for(const key of keyList)if(!constantList[key])throw new Error("[error] undefined setting constant: "+key);return constantList},browserServerSetting_default=settingList,userHmacSecret="xlogin20220630",scopeExtraConfigList={"auth:backupEmailAddress":{templateId:"#permissionCheckBlackTemplate",dialogConfirm:!0}},bsc=browserServerSetting_exports,settingList2={userHmacSecret:userHmacSecret,scopeExtraConfigList:scopeExtraConfigList},getBrowserServerSetting=()=>browserServerSetting_exports,get2=(...keyList)=>{var constantList=keyList.reduce((prev,curr)=>(prev[curr]=settingList2[curr],prev),{});for(const key of keyList)if(!constantList[key])throw new Error("[error] undefined setting constant: "+key);return constantList},lib_exports={},getCaller=(__export(lib_exports,{buf2Hex:()=>buf2Hex,calcHmac512:()=>calcHmac512,calcPbkdf2:()=>calcPbkdf2,genSalt:()=>genSalt,getCaller:()=>getCaller,getErrorModalElmAndSetter:()=>getErrorModalElmAndSetter,getModalElmAndSetter:()=>getModalElmAndSetter,getRandomStr:()=>getRandomStr,getRequest:()=>getRequest,getSearchQuery:()=>getSearchQuery,monkeyPatch:()=>monkeyPatch,postRequest:()=>postRequest,redirect:()=>redirect,setOnClickNavManu:()=>setOnClickNavManu,setOnClickNotification:()=>setOnClickNotification,showGlobalNotification:()=>showGlobalNotification,showModal:()=>showModal,slideDown:()=>slideDown,slideToggle:()=>slideToggle,slideUp:()=>slideUp,switchLoading:()=>switchLoading}),()=>{return(new Error).stack.replace(/^Error\n.*\n.*\n/,"")}),getRequest=(_url,param={})=>{var query=param&&Object.keys(param).map(key=>key+"="+param[key]).join("&");return fetch(query?_url+"?"+query:_url,{method:"GET",credentials:"same-origin",timeout:3e4}).then(res=>!res.error&&res.body&&res.json?res.json():null).catch(e=>(console.error("[fatal] error @getRequest:",e),null))},postRequest=(url,param={})=>{var opt={method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},timeout:3e4};return param&&(opt.body=JSON.stringify(param)),fetch(url,opt).then(res=>!res.error&&res.body&&res.json?res.json():null).catch(e=>(console.error("[fatal] error @postRequest:",e),null))},applyElmList=(query,f,parent=document)=>{Object.values(parent.querySelectorAll(query)).forEach(elm=>{f(elm)})},closeModal=()=>{applyElmList('[data-id="modal"], #modalBackground',elm=>{elm.classList.add("hidden")})},showModal=(modalElm,cancelButtonIsVisible=!1)=>new Promise(resolve=>{"modalTemplate"===modalElm.id&&(modalElm.id=""),document.body.appendChild(modalElm),closeModal(),setTimeout(()=>{applyElmList('[data-id="modalClose"], [data-id="modalCancelButton"]',elm=>{elm.onclick=()=>(closeModal(),resolve(!1))},document),cancelButtonIsVisible?modalElm.querySelector('[data-id="modalCancelButton"]').classList.remove("hidden"):modalElm.querySelector('[data-id="modalCancelButton"]').classList.add("hidden"),modalElm.querySelector('[data-id="modalConfirmButton"]').onclick=()=>(closeModal(),resolve(!0)),modalElm.classList.remove("hidden"),document.querySelector("#modalBackground").classList.remove("hidden"),modalElm.querySelector('[data-id="modalContent"]').scrollTop=0,modalElm.querySelector('[data-id="modalCard"]').onclick=e=>{e.stopPropagation()},modalElm.onclick=e=>(e.stopPropagation(),closeModal(),resolve(!1))},100)}),getErrorModalElmAndSetter=()=>{var modalElm=document.querySelector("#modalTemplate").cloneNode(!0);const modalTitleElm=modalElm.querySelector('[data-id="modalTitle"]'),labelP=(modalTitleElm.innerText="エラー",document.createElement("p"));labelP.innerText="エラーが発生しました。",modalElm.querySelector('[data-id="modalContent"]').appendChild(labelP);return{modalElm:modalElm,setContent:(textStr,errorLabelList=null,title="エラー")=>{labelP.innerText=errorLabelList&&errorLabelList[textStr]||textStr,modalTitleElm.innerText=title}}},getModalElmAndSetter=()=>{var modalElm=document.querySelector("#modalTemplate").cloneNode(!0);const modalTitleElm=modalElm.querySelector('[data-id="modalTitle"]'),modalContentElm=modalElm.querySelector('[data-id="modalContent"]');return{modalElm:modalElm,setContentElm:(title,contentElm)=>{modalTitleElm.innerText=title,modalContentElm.clearChildren(),modalContentElm.appendChild(contentElm)}}},switchLoading=isVisible=>{var loadingElm=document.querySelector("#loading");loadingElm&&(isVisible?loadingElm.classList.remove("hidden"):loadingElm.classList.add("hidden"))},setOnClickNavManu=()=>{var toggleElm=document.querySelector("#commonNavToggle");const navContentElm=document.querySelector("#commonNavContent");toggleElm.onclick=()=>{0<=[...navContentElm.classList.values()].indexOf("hidden")?navContentElm.classList.remove("hidden"):navContentElm.classList.add("hidden")}},notificationIsVisible=!1,showGlobalNotification=async apiEndpoint2=>{apiEndpoint2=await getRequest(apiEndpoint2+"/notification/global/list");const notificationContainerElm=document.querySelector("#notificationContainer"),notificationTemplateElm=(notificationContainerElm.clearChildren(),document.querySelector("#notificationTemplate")),notificationList=Object.values(apiEndpoint2?.result?.globalNotificationList||{}).reverse();notificationList.forEach((row,i)=>{const notificationElm=notificationTemplateElm.cloneNode(!0);notificationElm.classList.remove("hidden"),notificationElm.querySelector('[data-id="subject"]').innerText=row.subject,notificationElm.onclick=e=>{e.preventDefault(),e.stopPropagation();e=document.querySelector("#modalTemplate").cloneNode(!0);e.classList.remove("hidden"),e.querySelector('[data-id="modalTitle"]').innerText=row.subject,e.querySelector('[data-id="modalContent"]').appendChild(document.createTextNode(row.detail)),showModal(e)},setTimeout(()=>{notificationElm.style.transitionDuration="0.5s",notificationElm.style.opacity=0,notificationContainerElm.appendChild(notificationElm),setTimeout(()=>{notificationElm.style.opacity=1},100)},.5*i*1e3),setTimeout(()=>{notificationElm.style.transitionDuration="0.2s",notificationElm.style.opacity=0},.5*notificationList.length*1e3+3e3+.2*i*1e3)}),setTimeout(()=>{notificationContainerElm.clearChildren(),notificationIsVisible=!1},.7*notificationList.length*1e3+3e3)},setOnClickNotification=apiEndpoint2=>{applyElmList('[data-id="notificationBtn"]',notificationBtn=>{notificationBtn.onclick=e=>{e.preventDefault(),e.stopPropagation(),notificationIsVisible||(notificationIsVisible=!0,showGlobalNotification(apiEndpoint2))}})},monkeyPatch=()=>{void 0===Element.prototype.clearChildren&&Object.defineProperty(Element.prototype,"clearChildren",{configurable:!0,enumerable:!1,value(){for(;this.firstChild;)this.removeChild(this.lastChild)}}),void 0===window.argNamed&&(window.argNamed=obj=>{const flattened={};return Object.keys(obj).forEach(key=>{Array.isArray(obj[key])?Object.assign(flattened,obj[key].reduce((prev,curr)=>{if(void 0===curr)throw new Error(`[error] flat argument by list can only contain function but: ${typeof curr} @${key}
===== maybe you need make func exported like  module.exports = { func, } =====`);if("function"!=typeof curr)throw new Error(`[error] flat argument by list can only contain function but: ${typeof curr} @`+key);return prev[curr.name]=curr,prev},{})):"object"==typeof obj[key]&&null!==obj[key]?Object.assign(flattened,obj[key]):flattened[key]=obj[key]}),flattened})},getRandomStr=len=>btoa(crypto.getRandomValues(new Uint8Array(len))).slice(0,len),buf2Hex=buf=>Array.prototype.map.call(new Uint8Array(buf),x=>("00"+x.toString(16)).slice(-2)).join(""),calcHmac512=(data,secret)=>new Promise(resolve=>{const enc=new TextEncoder("utf-8");window.crypto.subtle.importKey("raw",enc.encode(secret),{name:"HMAC",hash:{name:"SHA-512"}},!1,["sign","verify"]).then(key=>{window.crypto.subtle.sign("HMAC",key,enc.encode(data)).then(hash=>{hash=new Uint8Array(hash);resolve(buf2Hex(hash))})})}),genSalt=()=>window.crypto.getRandomValues(new Uint8Array(64)),calcPbkdf2=(str,salt)=>new Promise(resolve=>{var byteList=new Uint8Array(Array.prototype.map.call(str,c=>c.charCodeAt(0)));window.crypto.subtle.importKey("raw",byteList,{name:"PBKDF2"},!1,["deriveBits"]).then(key=>{return window.crypto.subtle.deriveBits({name:"PBKDF2",salt:salt,iterations:1e6,hash:{name:"SHA-512"}},key,512).then(buf=>{resolve(buf2Hex(buf))})})}),redirect=response=>{response&&response.redirect&&(window.location.href=response.redirect)},getSearchQuery=()=>{const searchQuery={};return window.location.search.replace(/^\?/,"").split("&").forEach(row=>{var[row,value]=row.split("=");searchQuery[row]=value}),searchQuery},slideUp=(elm,duration=300)=>{elm.style.height=elm.offsetHeight+"px",null!==elm.offsetHeight&&(elm.style.transitionProperty="height, margin, padding",elm.style.transitionDuration=duration+"ms",elm.style.transitionTimingFunction="ease",elm.style.overflow="hidden",elm.style.height=0,elm.style.paddingTop=0,elm.style.paddingBottom=0,elm.style.marginTop=0,elm.style.marginBottom=0,setTimeout(()=>{elm.style.display="none",elm.style.removeProperty("height"),elm.style.removeProperty("padding-top"),elm.style.removeProperty("padding-bottom"),elm.style.removeProperty("margin-top"),elm.style.removeProperty("margin-bottom"),elm.style.removeProperty("overflow"),elm.style.removeProperty("transition-duration"),elm.style.removeProperty("transition-property"),elm.style.removeProperty("transition-timing-function")},duration))},slideDown=(elm,duration=300)=>{elm.style.removeProperty("display");let display=window.getComputedStyle(elm)["display"];"none"===display&&(display="block"),elm.style.display=display;var height=elm.offsetHeight;elm.style.overflow="hidden",elm.style.height=0,elm.style.paddingTop=0,elm.style.paddingBottom=0,elm.style.marginTop=0,elm.style.marginBottom=0,null!==elm.offsetHeight&&(elm.style.transitionProperty="height, margin, padding",elm.style.transitionDuration=duration+"ms",elm.style.transitionTimingFunction="ease",elm.style.height=height+"px",elm.style.removeProperty("padding-top"),elm.style.removeProperty("padding-bottom"),elm.style.removeProperty("margin-top"),elm.style.removeProperty("margin-bottom"),setTimeout(()=>{elm.style.removeProperty("height"),elm.style.removeProperty("overflow"),elm.style.removeProperty("transition-duration"),elm.style.removeProperty("transition-property"),elm.style.removeProperty("transition-timing-function")},duration))},slideToggle=(elm,duration=300,ignoreIfOpen=!1)=>{"none"===window.getComputedStyle(elm).display?slideDown(elm,duration):ignoreIfOpen||slideUp(elm,duration)},output_exports={},showErrorModal=(__export(output_exports,{default:()=>output_default,showErrorModal:()=>showErrorModal}),({getSearchQuery:getSearchQuery2,getErrorModalElmAndSetter:getErrorModalElmAndSetter2,showModal:showModal2,labelList:labelList2})=>{var getSearchQuery2=getSearchQuery2().error,{modalElm:getErrorModalElmAndSetter2,setContent}=getErrorModalElmAndSetter2();setContent(getSearchQuery2,labelList2.error),showModal2(getErrorModalElmAndSetter2)}),output_default={},__export={},a=(__export.setting=setting_exports,__export.lib=lib_exports,__export.output=output_exports,__export);a.app={main:async()=>{a.lib.switchLoading(!0),a.lib.setOnClickNavManu(),a.lib.setOnClickNotification(a.setting.bsc.apiEndpoint),a.lib.monkeyPatch(),a.app.loadErrorMessage(),setTimeout(()=>{a.lib.switchLoading(!1)},300)},loadErrorMessage:()=>{a.output.showErrorModal(argNamed({lib:[a.lib.getSearchQuery,a.lib.getErrorModalElmAndSetter,a.lib.showModal],setting:a.setting.bsc.get("labelList")}))}},a.app.main()})();