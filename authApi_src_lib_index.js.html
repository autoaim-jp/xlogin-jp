<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: authApi/src/lib/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: authApi/src/lib/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* /lib/index.js */
import backendServerLib from './backendServerLib.js'

/**
 * @file
 * @name アプリケーション全体で共通で使用するライブラリ
 * @memberof lib
 */
const mod = {}

/**
 * init.
 *
 * @param {} crypto
 * @param {} ulid
 * @return {undefined} 戻り値なし
 * @memberof lib
 */
const init = ({ crypto, ulid }) => {
  mod.crypto = crypto
  backendServerLib.init({ crypto, ulid })
}

/**
 * convertToCodeChallenge.
 *
 * @param {} codeVerifier
 * @param {} codeChallengeMethod
 * @return {string} 作成したcodeChallenge
 * @memberof lib
 */
const convertToCodeChallenge = ({ codeVerifier, codeChallengeMethod }) => {
  /**
   * calcSha256AsB64Url.
   *
   * @param {} str
   */
  const calcSha256AsB64Url = ({ str }) => {
    const sha256 = mod.crypto.createHash('sha256')
    sha256.update(str)
    return sha256.digest('base64url')
  }

  if (codeChallengeMethod === 'S256') {
    return calcSha256AsB64Url({ str: codeVerifier })
  }
  throw new Error('unimplemented')
}

/**
 * calcPbkdf2.
 *
 * @param {} data
 * @param {} saltHex
 * @return {Promise(string)} 計算したPBKDF2
 * @memberof lib
 */
const calcPbkdf2 = ({ data, saltHex }) => {
  return new Promise((resolve) => {
    mod.crypto.pbkdf2(data, Buffer.from(saltHex, 'hex'), 1000 * 1000, 64, 'sha512', (err, derivedKey) => {
      if (err) {
        return resolve(null)
      }
      return resolve(derivedKey.toString('hex'))
    })
  })
}

/**
 * getMaxIdInList.
 *
 * @param {} list
 * @return {string} リストの最大値
 * @memberof lib
 */
const getMaxIdInList = ({ list }) => {
  return list.reduce((p, c) => {
    return p > c ? p : c
  })
}

export default {
  backendServerLib,

  init,

  convertToCodeChallenge,
  calcPbkdf2,
  getMaxIdInList,
}

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="action.html">action</a></li><li><a href="app.html">app</a></li><li><a href="core.html">core</a></li><li><a href="input.html">input</a></li><li><a href="lib.html">lib</a></li><li><a href="output.html">output</a></li><li><a href="setting.html">setting</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Sat Oct 21 2023 13:03:56 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
